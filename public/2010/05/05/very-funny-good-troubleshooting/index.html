<!DOCTYPE html>
<html>

    <head>
        <title> Very funny, good troubleshooting &middot;  </title>

        <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.123.7">




<script src="https://code.jquery.com/jquery-3.1.1.min.js"   integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="   crossorigin="anonymous"></script>


<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>


<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">


<link rel="stylesheet" href="https://cmdln.org/css/nix.css">





<link href="https://fonts.googleapis.com/css?family=Inconsolata%7COpen+Sans%7CConcert+One" rel="stylesheet">






    </head>

    <body>
        <header>
	<nav class="navbar navbar-dark bg-dark fixed-top navbar-expand-lg font-header">
		<div class="container-fluid">
			<a class="navbar-brand" id="green-terminal" href='https://cmdln.org/'>
				nick@cmdln.org ~ $
			</a>
			<button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse-1" 
					aria-controls="navbar-collapse-1" aria-expanded="false">
				<span class="visually-hidden">Toggle navigation</span>
				<span class="navbar-toggler-icon"></span>
			</button>
	
			
			<div class="collapse navbar-collapse" id="navbar-collapse-1">
				<ul class="nav navbar-nav ms-auto">
					<li class="nav-item">
						<a class="nav-link" href='https://cmdln.org/'>
							/home/nick</a>
					</li>
					
					
					
					<li class="nav-item dropdown">
						
						<a class="nav-link" href="https://cmdln.org/post/">~/posts</a>
						
					</li>
					
				</ul>
			</div>
		</div>
	</nav>
</header>

        <div class="flex-wrapper">
            <div class="container wrapper">
                <h1><a href="https://cmdln.org/2010/05/05/very-funny-good-troubleshooting/">Very funny, good troubleshooting</a></h1>
                <span class="post-date">2010-05-06 </span>
                <div class="post-content">
                    <p>This deserved a repost. Originally sourced from <a href="http://www.csua.berkeley.edu/~ranga/humor/500_mile_email.txt">http://www.csua.berkeley.edu/~ranga/humor/500_mile_email.txt</a></p>
<blockquote>
<pre>To: 0xdeadbeef@petting-zoo.net
</blockquote>
<p>Subject: The case of the 500-mile email.
Date: Tue, 26 Nov 2002 14:57:40 -0800</p>
<p>Here&rsquo;s a problem that <em>sounded</em> impossible&hellip;  I almost regret posting
the story to a wide audience, because it makes a great tale over
drinks at a conference. :-) The story is slightly altered in order to
protect the guilty, elide over irrelevant and boring details, and
generally make the whole thing more entertaining.</p>
<p>I was working in a job running the campus email system some years ago
when I got a call from the chairman of the statistics department.</p>
<p>&ldquo;We&rsquo;re having a problem sending email out of the department.&rdquo;</p>
<p>&ldquo;What&rsquo;s the problem?&rdquo; I asked.</p>
<p>&ldquo;We can&rsquo;t send mail more than 500 miles,&rdquo; the chairman explained.</p>
<p>I choked on my latte.  &ldquo;Come again?&rdquo;</p>
<p>&ldquo;We can&rsquo;t send mail farther than 500 miles from here,&rdquo; he repeated.
&ldquo;A little bit more, actually.  Call it 520 miles.  But no farther.&rdquo;</p>
<p>&ldquo;Um&hellip; Email really doesn&rsquo;t work that way, generally,&rdquo; I said, trying
to keep panic out of my voice.  One doesn&rsquo;t display panic when
speaking to a department chairman, even of a relatively impoverished
department like statistics.  &ldquo;What makes you think you can&rsquo;t send mail
more than 500 miles?&rdquo;</p>
<p>&ldquo;It&rsquo;s not what I <em>think</em>,&rdquo; the chairman replied testily.  &ldquo;You see,
when we first noticed this happening, a few days ago&ndash;&rdquo;</p>
<p>&ldquo;You waited a few DAYS?&rdquo; I interrupted, a tremor tinging my voice.
&ldquo;And you couldn&rsquo;t send email this whole time?&rdquo;</p>
<p>&ldquo;We could send email.  Just not more than&ndash;&rdquo;</p>
<p>&ldquo;&ndash;500 miles, yes,&rdquo; I finished for him, &ldquo;I got that.  But why didn&rsquo;t
you call earlier?&rdquo;</p>
<p>&ldquo;Well, we hadn&rsquo;t collected enough data to be sure of what was going on
until just now.&rdquo;  Right.  This is the chairman of
<em>statistics</em>. &ldquo;Anyway, I asked one of the geostatisticians to look
into it&ndash;&rdquo;</p>
<p>&ldquo;Geostatisticians&hellip;&rdquo;</p>
<p>&ldquo;&ndash;yes, and she&rsquo;s produced a map showing the radius within which we
can send email to be slightly more than 500 miles.  There are a number
of destinations within that radius that we can&rsquo;t reach, either, or
reach sporadically, but we can never email farther than this radius.&rdquo;</p>
<p>&ldquo;I see,&rdquo; I said, and put my head in my hands.  &ldquo;When did this start?
A few days ago, you said, but did anything change in your systems at
that time?&rdquo;</p>
<p>&ldquo;Well, the consultant came in and patched our server and rebooted it.
But I called him, and he said he didn&rsquo;t touch the mail system.&rdquo;</p>
<p>&ldquo;Okay, let me take a look, and I&rsquo;ll call you back,&rdquo; I said, scarcely
believing that I was playing along.  It wasn&rsquo;t April Fool&rsquo;s Day.  I
tried to remember if someone owed me a practical joke.</p>
<p>I logged into their department&rsquo;s server, and sent a few test mails.
This was in the Research Triangle of North Carolina, and a test mail
to my own account was delivered without a hitch.  Ditto for one sent
to Richmond, and Atlanta, and Washington.  Another to Princeton (400
miles) worked.</p>
<p>But then I tried to send an email to Memphis (600 miles).  It failed.
Boston, failed.  Detroit, failed.  I got out my address book and
started trying to narrow this down.  New York (420 miles) worked, but
Providence (580 miles) failed.</p>
<p>I was beginning to wonder if I had lost my sanity.  I tried emailing a
friend who lived in North Carolina, but whose ISP was in Seattle.
Thankfully, it failed.  If the problem had had to do with the
geography of the human recipient and not his mail server, I think I
would have broken down in tears.</p>
<p>Having established that &ndash; unbelievably &ndash; the problem as reported was
true, and repeatable, I took a look at the sendmail.cf file.  It
looked fairly normal.  In fact, it looked familiar.</p>
<p>I diffed it against the sendmail.cf in my home directory.  It hadn&rsquo;t
been altered &ndash; it was a sendmail.cf I had written.  And I was fairly
certain I hadn&rsquo;t enabled the &ldquo;FAIL_MAIL_OVER_500_MILES&rdquo; option.  At a
loss, I telnetted into the SMTP port.  The server happily responded
with a SunOS sendmail banner.</p>
<p>Wait a minute&hellip; a SunOS sendmail banner?  At the time, Sun was still
shipping Sendmail 5 with its operating system, even though Sendmail 8
was fairly mature.  Being a good system administrator, I had
standardized on Sendmail 8.  And also being a good system
administrator, I had written a sendmail.cf that used the nice long
self-documenting option and variable names available in Sendmail 8
rather than the cryptic punctuation-mark codes that had been used in
Sendmail 5.</p>
<p>The pieces fell into place, all at once, and I again choked on the
dregs of my now-cold latte.  When the consultant had &ldquo;patched the
server,&rdquo; he had apparently upgraded the version of SunOS, and in so
doing <em>downgraded</em> Sendmail.  The upgrade helpfully left the
sendmail.cf alone, even though it was now the wrong version.</p>
<p>It so happens that Sendmail 5 &ndash; at least, the version that Sun
shipped, which had some tweaks &ndash; could deal with the Sendmail 8
sendmail.cf, as most of the rules had at that point remained
unaltered.  But the new long configuration options &ndash; those it saw as
junk, and skipped.  And the sendmail binary had no defaults compiled
in for most of these, so, finding no suitable settings in the
sendmail.cf file, they were set to zero.</p>
<p>One of the settings that was set to zero was the timeout to connect to
the remote SMTP server.  Some experimentation established that on this
particular machine with its typical load, a zero timeout would abort a
connect call in slightly over three milliseconds.</p>
<p>An odd feature of our campus network at the time was that it was 100%
switched.  An outgoing packet wouldn&rsquo;t incur a router delay until
hitting the POP and reaching a router on the far side.  So time to
connect to a lightly-loaded remote host on a nearby network would
actually largely be governed by the speed of light distance to the
destination rather than by incidental router delays.</p>
<p>Feeling slightly giddy, I typed into my shell:</p>
<p>$ units
1311 units, 63 prefixes</p>
<p>You have: 3 millilightseconds
You want: miles
* 558.84719
/ 0.0017893979</p>
<p>&ldquo;500 miles, or a little bit more.&rdquo;</p>
<p>Trey Harris
</pre></p>

                </div>
                
                <div class="post-comments">
                    
                </div>
                
            </div>
            <footer class="footer text-center">
<p>Copyright &copy; 2024 Nick Anderson -
<span class="credit">
	Powered by
	<a target="_blank" href="https://gohugo.io">Hugo</a>
	and
	<a target="_blank" href="https://github.com/LordMathis/hugo-theme-nix/">Nix</a> theme.
</span>
</p>
</footer>

        </div>
    </body>
